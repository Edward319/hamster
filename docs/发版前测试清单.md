# 发版前测试清单

> **何时用**：每次要推送 Git、部署到 Vercel、或把链接发给别人之前，按本清单在**真实环境**（本地或已部署的网址）里跑一遍并打勾。  
> **怎么用**：在 `[ ]` 里打成 `[x]` 表示该项已通过；若有失败，在对应项下简短写一句现象，方便后续修。

---

## 1. 打开与导航

- [ ] 用浏览器打开应用（本地 `index.html` 或部署后的网址），无报错、无空白屏。
- [ ] 底部四个入口：首页、库存、管家、设置，点击能正确切换页面。

---

## 2. 首页

- [ ] 无数据时显示「今天没有快过期的东西，真棒！」或等价空状态。
- [ ] 有即将到期数据时，今日提醒表格有表头（物品、品牌、品类、到期、提前提醒）且数据正确。
- [ ] 「发送今日报告到邮箱」点击后，若已填邮箱则出现发送中/已发送或错误提示；未填邮箱则提示先去设置填邮箱。

---

## 3. 货单总结（首页下方）

- [ ] 显示「统计周期：过去 N 周」小字（N 与设置里「进货总结统计周期」一致）。
- [ ] 进货 / 消耗 区块可展开；展开后表格有列头（物品、品牌、二级品类、总价），数据为合并后（同物品+品牌+二级品类合并为一行），无过期日列。

---

## 4. 库存管理

- [ ] 点击「进货」能弹出登记表单；填写必填项后保存，列表中出现新记录或对应 SKU 数量增加。
- [ ] 列表可切换「在库」「已用完」；在库时显示在库数据，已用完时显示已用完数据。
- [ ] 某条「用完了」：点击用完了、填写本次使用数量并确定后，该条从未用完列表减少或进入已用完列表。
- [ ] 编辑：点击某条编辑，修改后保存，列表更新正确。
- [ ] 删除：点击删除并确认后，该条从列表消失。

---

## 5. 设置

- [ ] **通知**：邮箱可填写并保存；通知频率、进货总结统计周期可切换并生效（首页货单总结周期与设置一致）。
- [ ] **数据保存**：切换「本地保存」与「Notion 保存」时，下方说明文案切换正确；选本地时出现「自动清理已用完数据」区块，选 Notion 时出现 Notion 配置区块。
- [ ] **本地保存时**：勾选「启用自动删除已用完记录」后出现「删除周期（周）」选项；取消勾选后该选项隐藏。
- [ ] **Notion 保存时**：填写集成密钥、数据库 ID（或创建新数据库）并保存后，再进入库存/首页，数据来源为 Notion（若已配置过，可只确认不报错、列表能加载）。

---

## 6. 邮件与 Notion（有则测）

- [ ] **邮件**：设置里已填邮箱时，首页点击「发送今日报告到邮箱」，应收到邮件或看到明确成功/失败提示；邮件内「货单总结」标题为「过去 N 周」（N 与设置里进货总结统计周期一致）。
- [ ] **定期自动发送**：勾选「定期自动发送报告」并保存后，进入首页会静默同步报告到服务端；取消勾选后不再自动发送。实际定时发信依赖 Vercel Cron + Gmail + KV，部署后按文档配置即可。
- [ ] **Notion**：若使用 Notion 保存，在 Notion 中新增/修改一条，回到应用刷新或重进库存，能看到变化（或至少无报错）。

---

## 7. 收尾

- [ ] 在浏览器控制台（F12 → Console）无红色报错（与当前操作相关的正常提示可忽略）。
- [ ] 打勾完成且无失败项后，即可进行推送/部署/分享。

---

*清单会随功能增加由 AI 协助增补；你只需按更新后的清单执行即可。*
