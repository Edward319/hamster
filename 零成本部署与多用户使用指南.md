# 零成本部署与多用户使用指南

> 目标：不花一分钱完成部署，并且能让不同的人各自使用、各自收到自己的邮件提醒。

---

## 一、为什么可以「零成本」且「多用户」？

### 1. 零成本从哪来？

| 项目 | 方案 | 费用 |
|------|------|------|
| **网站托管** | Vercel 免费版 | 0 元。静态页面 + 云函数都在免费额度内。 |
| **发邮件** | Resend 免费版 | 0 元。每月约 3000 封、每天约 100 封以内免费。 |
| **域名** | 使用 Vercel 默认域名 `xxx.vercel.app` | 0 元。若要用自己的域名，只需付域名注册费（可选）。 |
| **用户数据** | 存在每个用户自己浏览器的 localStorage | 0 元。不需要数据库，不占用你的服务器。 |
| **未来：Notion 同步** | 各用户连接**自己的** Notion，应用只调各自用户的 Notion API | 0 元。不占我们服务器存储，Notion 免费版即可。 |

所以：**不买服务器、不买数据库、不买域名，也可以完成本次开发并给不同用户使用；后续 Notion 同步仍保持「各用户用各自 Notion」的零成本方案。**

### 2. 「不同用户」是怎么工作的？

- **同一个网址**：你只部署一次，得到一个链接，例如 `https://存货小管家.vercel.app`。
- **每人自己的数据**：每个用户用自己手机/电脑的浏览器打开这个链接。库存、设置、通知邮箱都保存在**该设备该浏览器**的 localStorage 里，互不干扰。
- **每人自己的邮件**：用户 A 在设置里填自己的邮箱，点「发送今日报告」→ 邮件发到 A 的邮箱；用户 B 填 B 的邮箱，点发送 → 邮件发到 B 的邮箱。  
  也就是说：**没有账号系统，但每个访问你网站的人，用的都是「自己的数据」+「自己的邮箱」。**

逻辑可以概括成：

```
你部署 1 个网站（1 个 URL）
    ↓
很多人用各自浏览器打开这个 URL
    ↓
每人浏览器里各有一份 localStorage（库存、设置、通知邮箱）
    ↓
谁点「发送今日报告」，就用自己的数据 + 自己的邮箱发一封邮件
    ↓
发信走的是你的 Vercel 云函数 + 你的 Resend 账号（免费额度内）
```

所以：**零成本 + 多用户 = 你只部署一次，多人访问同一链接，各自用各自的数据、各自收各自的邮件。**

---

## 二、下一步你要做什么（按顺序）

整体顺序：**先部署网站 → 再配发信 → 自己试一遍 → 把链接发给别人用。**

---

### 第 1 步：注册并部署到 Vercel（约 5 分钟）

1. **注册 Vercel**  
   - 打开 [https://vercel.com](https://vercel.com) → Sign Up。  
   - 建议用 GitHub 登录（后面用 GitHub 部署最省事；用邮箱也可以）。

2. **把项目放到 GitHub（如果还没有）**  
   - 在 [GitHub](https://github.com) 新建一个仓库（例如 `vibecoding`）。  
   - 在你自己电脑的项目文件夹里（即本地的 `vibecoding` 目录）执行：
     ```bash
     git init
     git add .
     git commit -m "Initial: 存货小管家"
     git branch -M main
     git remote add origin https://github.com/你的用户名/vibecoding.git
     git push -u origin main
     ```
   - 若你已有仓库、已连好，只需 `git add .` → `git commit` → `git push` 即可。

3. **在 Vercel 里从 GitHub 导入并部署**  
   - 登录 Vercel → 点击 **Add New…** → **Project**。  
   - 选择 **Import Git Repository**，选你刚推送的 `vibecoding` 仓库。  
   - **Framework Preset** 保持 **Other** 或选 **Vite** 无所谓（我们主要是静态 + API 路由）。  
   - **Root Directory** 不动。  
   - 直接点 **Deploy**，等一两分钟。  
   - 部署完成后会给你一个地址，形如：`https://vibecoding-xxx.vercel.app`。  
   - 用浏览器打开这个地址，能正常看到「存货小管家」页面，说明**网站已零成本上线**。

**逻辑**：Vercel 会帮你把 `index.html`、`js`、`css` 当静态站发布，并把 `api/send-report.js` 当成「收到 `/api/send-report` 请求时执行的函数」。所以前端和发信接口在同一个域名下，前端用相对路径 `/api/send-report` 即可，无需再配 CORS 或域名。

---

### 第 2 步：配置发信（二选一）

**方案 A：Gmail（0 成本、无需域名，任意收件人都能收到，推荐）**

1. 用你的 **Gmail** 打开 [Google 账户 → 安全设置](https://myaccount.google.com/security)。  
2. 开启 **两步验证**（已开启可跳过）。  
3. 在安全页找到 **「应用专用密码」**（App passwords），选择「邮件」和「其他设备」，生成 16 位密码并**复制保存**（只显示一次）。  
4. 在 Vercel 项目 → **Settings** → **Environment Variables** 添加：`SMTP_USER` = 你的 Gmail 邮箱，`SMTP_PASS` = 应用专用密码。**不要**设置 `RESEND_API_KEY`（有则删除）。  
5. **Deployments** → **Redeploy** 一次。

**方案 B：Resend**

1. 打开 [https://resend.com](https://resend.com) → 注册/登录。  
2. 进入 **API Keys** → **Create API Key**，复制保存（只显示一次）。  
3. 在 Vercel 里添加 **`RESEND_API_KEY`** = 复制的 Key。  
4. 未验证域名时只有你注册 Resend 的邮箱能收到；要让别人收到需验证域名并设 `RESEND_FROM`（见下方常见问题）。  
5. 保存后 **Redeploy**。

**逻辑**：Gmail 用你自己的账号发信，0 元、无域名、任意收件人可收（约 500 封/天）。Resend 免费约 3000 封/月，不验证域名时仅限注册邮箱。

---

### 第 3 步：确认环境变量并重新部署

1. 打开 Vercel 控制台 → 进入你的项目。  
2. **Settings** → **Environment Variables**，确认第 2 步里选的方案已填好（Gmail：`SMTP_USER` + `SMTP_PASS`；Resend：`RESEND_API_KEY`；若用 Resend 且已验证域名，可再加 `RESEND_FROM`）。  
3. **Deployments** → 最新一次部署右侧 **⋯** → **Redeploy**，或执行 `git push` 触发部署。

**重要**：改完环境变量后必须 **Redeploy**，云函数才会读到新变量。

---

### 第 4 步：自己先完整走通一遍（约 2 分钟）

1. 用浏览器打开你的 Vercel 地址（例如 `https://vibecoding-xxx.vercel.app`）。  
2. 打开 **设置** → 在「通知邮箱」里填**你自己的邮箱** → 保存。  
3. 回到 **首页** → 点 **「发送今日报告到邮箱」**。  
4. 看页面提示是否「已发送到 xxx」。  
5. 去你的邮箱（含垃圾邮件）查收，应收到一封信纸风、带小仓鼠的今日报告。

若失败：  
- 看页面上报错内容。  
- 到 Vercel 项目 **Deployments** → 点最新部署 → **Functions** → 选 `api/send-report`，看运行日志里的报错。  
- 常见问题：环境变量没保存、没 Redeploy、或 Resend Key 填错。

**逻辑**：你相当于「第一个用户」。你这一套走通，就证明：同一链接下，任何人只要填自己的邮箱，就能把**自己的今日报告**发到**自己的邮箱**。

---

### 第 5 步：把链接发给别人用（多用户）

- 把 Vercel 的访问地址发给朋友/家人，例如：  
  `https://vibecoding-xxx.vercel.app`  
- 对方用手机或电脑浏览器打开：  
  - 看到的是同一套「存货小管家」界面。  
  - 但他浏览器里的 localStorage 是空的，所以库存、设置都是**他的**，和你的互不影响。  
  - 他在设置里填**自己的**通知邮箱，点「发送今日报告」→ 邮件发到**他的**邮箱。  

无需你给他们建账号、开权限；他们也不需要登录。**多用户 = 多人用同一个链接，各自用各自的数据、各自收各自的邮件。**

---

### 常见问题：只有我能收到邮件，其他人填的邮箱收不到

**若你用的是 Resend**：未设置 `RESEND_FROM` 时，发件人用的是 Resend 的测试地址，Resend **只会把邮件投递到你注册时使用的邮箱**。

**0 成本解决办法（推荐）**：改用 **Gmail 发信**。在 Vercel 环境变量中**删除或不要设置** `RESEND_API_KEY`，只设置 **`SMTP_USER`**（你的 Gmail）和 **`SMTP_PASS`**（Gmail 应用专用密码），保存后 Redeploy。之后任意用户填的邮箱都能收到，无需域名。详见上方「第 2 步 · 方案 A」。

**若坚持用 Resend**：在 Resend 里**添加并验证你自己的域名**，并设置 `RESEND_FROM`。

1. 打开 [Resend Dashboard](https://resend.com/domains) → **Domains** → **Add Domain**。  
2. 输入你拥有的域名（如 `yourdomain.com` 或子域如 `mail.yourdomain.com`），按页面提示到域名服务商（如阿里云、Cloudflare、Namesilo 等）添加 Resend 给出的 **SPF**、**DKIM** 等 DNS 记录。  
3. 在 Resend 里点 **Verify**，状态变为 **Verified** 后，在 Vercel 项目 **Settings → Environment Variables** 中新增：  
   - **Name**：`RESEND_FROM`  
   - **Value**：`存货小管家 <noreply@你的域名.com>`（把 `你的域名.com` 换成你验证的域名）  
4. 到 **Deployments** 里 **Redeploy** 一次。  

完成后，任意用户填写的通知邮箱都能收到报告。若暂时没有域名，可先只用「自己注册的邮箱」接收测试。

---

## 三、零成本的边界（心里有数即可）

- **Resend**：免费约 3000 封/月、100 封/天。若以后用户量或点击量特别大，再考虑付费或换方案。  
- **Vercel**：免费版对个人/小项目足够；若流量异常大，再看是否触发限制。  
- **数据**：每个用户的数据只在各自浏览器里，你不存用户数据，所以没有数据库费用；但用户换设备或清空浏览器数据会丢，这是当前设计的取舍（若要跨设备同步，需要后续做 Notion 等同步，那是另一个阶段）。

---

## 四、小结：下一步清单

| 顺序 | 做什么 | 结果 |
|------|--------|------|
| 1 | 注册 Vercel，用 GitHub 导入项目并 Deploy | 得到一个可访问的网址 |
| 2 | 注册 Resend，创建并复制 API Key | 拿到发信凭证 |
| 3 | 在 Vercel 项目里添加 `RESEND_API_KEY`，并 Redeploy | 云函数能发邮件 |
| 4 | 自己打开网址 → 设置里填邮箱 → 首页点发送 → 收邮件 | 验证整条链路 |
| 5 | 把网址发给别人 | 不同用户各自使用、各自收邮件 |

按上面 1→2→3→4→5 做完，就是**零成本完成本次开发，并能给不同用户使用**的完整路径；逻辑就是：**一人部署，多人同链接，数据在各自浏览器，发信用你的免费额度。**
